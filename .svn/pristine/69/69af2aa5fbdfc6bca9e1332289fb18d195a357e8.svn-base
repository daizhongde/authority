package com.asiainfo.authority.hibernate.batch;

import java.util.List;

import org.hibernate.Session;
import org.hibernate.Transaction;
import org.springframework.orm.hibernate3.support.HibernateDaoSupport;

public class HibernateBatchInsert  extends HibernateDaoSupport{
	@SuppressWarnings("deprecation")
	public void batchInsert(final List rows)
	{
		Session session = this.getSession(true);
//	  long begin = System.currentTimeMillis();  
	  Transaction tx = session.beginTransaction();     
        for ( int i=0, j = rows.size(); i<j; i++ ) { //插入100万条数据  
            session.save( rows.get(i) );   
            if(i%100==0){   //每一千条刷新并写入数据库  
                session.flush();  
                session.clear();  
            }
        }
        tx.commit();   
        session.close();  
//        long end = System.currentTimeMillis();  
//        System.out.println((end-begin)/1000.0);
	}
}
