<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
    TOOL.T_AUTHORITY_USER  
    LXC.T_XT_YHXX
-->
<hibernate-mapping>
    <class name="com.asiainfo.authority.hibernate.pojo.TAuthorityUser" table="T_AUTHORITY_USER" schema="tool"
		dynamic-insert="true" dynamic-update="true" >
        <id name="NUid" type="java.lang.Integer">
            <column name="N_UID" precision="8" scale="0" />
            <generator class="identity" />
        </id>
        <many-to-one name="TAuthorityInst" class="com.asiainfo.authority.hibernate.pojo.TAuthorityInst" fetch="select" unique="true" lazy="false" >
            <column name="N_DID" precision="8" scale="0" not-null="true" />
        </many-to-one>
         <property name="NIid" type="java.lang.Integer">
            <column name="N_IID" precision="9" scale="0" />
        </property>
        <property name="CUlogname" type="java.lang.String">
            <column name="C_ULOGNAME" length="24" not-null="true" unique="true" />
        </property>
        <property name="CUname" type="java.lang.String">
            <column name="C_UNAME" length="90" not-null="true" />
        </property>
        <property name="CUpassword" type="java.lang.String">
            <column name="C_UPASSWORD" length="40" not-null="true" />
        </property>
        <property name="CUsex" type="java.lang.String">
            <column name="C_USEX" length="6" not-null="true" />
        </property>
        <property name="EmployeeNumber" type="java.lang.String">
            <column name="EMPLOYEE_NUMBER" length="10" not-null="true" />
        </property>
        <property name="SupervisorId" type="java.lang.Integer">
            <column name="SUPERVISOR_ID" precision="8" scale="0"/>
        </property>
        <!--  -->
        <property name="CIname" type="java.lang.String" update="false" insert="false">
        	<formula>
        	<![CDATA[
        	f_getInstNameById(N_IID)
        	]]> 
        	</formula>
        </property>
        <property name="CDname" type="java.lang.String" update="false" insert="false">
        	<formula>
        	<![CDATA[
        	f_getInstNameById(N_DID) 
        	]]> 
        	</formula>
        </property>
        <property name="SupervisorName" type="java.lang.String" update="false" insert="false">
        	<formula>
        	<![CDATA[
        	f_getPUserIdById(supervisor_id)
        	]]> 
        	</formula>
        </property>
        <property name="FollowerNum" type="java.lang.Integer" update="false" insert="false">
        	<formula>
        	<![CDATA[
        	(SELECT COUNT(*) FROM tool.t_authority_user t2 WHERE t2.supervisor_id = n_uid)
        	]]> 
        	</formula>
        </property>
        
        <property name="CUphone" type="java.lang.String">
            <column name="C_UPHONE" length="15" />
        </property>
        <property name="CUemail" type="java.lang.String">
            <column name="C_UEMAIL" length="40" />
        </property>
        <property name="CUqq" type="java.lang.String">
            <column name="C_UQQ" length="10" />
        </property>
        <property name="CUaddr" type="java.lang.String">
            <column name="C_UADDR" length="120" />
        </property>
        <property name="CUnote" type="java.lang.String">
            <column name="C_UNOTE" length="512" />
        </property>
        <property name="CUtel" type="java.lang.String">
            <column name="C_UTEL" length="100" />
        </property>
        <property name="CUfax" type="java.lang.String">
            <column name="C_UFAX" length="15" />
        </property>
        <property name="CUctime" type="java.util.Date" insert="false">
            <column name="C_UCTIME" length="7" not-null="false" />
        </property>
        <property name="CUcip" type="java.lang.String">
            <column name="C_UCIP" length="60" />
        </property>
        <property name="CUcreator" type="java.lang.String">
            <column name="C_UCREATOR" length="24" />
        </property>
        <property name="CUmtime" type="java.util.Date" insert="false">
            <column name="C_UMTIME" length="7" />
        </property>
        <property name="CUmip" type="java.lang.String">
            <column name="C_UMIP" length="60" />
        </property>
        <property name="CUmodifier" type="java.lang.String">
            <column name="C_UMODIFIER" length="24" />
        </property>
        <property name="CUons" type="java.lang.String" insert="false">
			<column name="C_UONS" length="1"/>
		</property>
		<property name="CUont" type="java.util.Date" insert="false">
			<column name="C_UONT" length="7" />
		</property>
		
		<property name="CLogins" type="java.lang.String" insert="false">
			<column name="C_LOGINS" length="1"/>
		</property>
		<property name="CLoginip" type="java.lang.String" insert="false">
            <column name="C_LOGINIP" length="60" />
        </property>
		<property name="CLogint" type="java.util.Date" insert="false">
			<column name="C_LOGINT" length="7" />
		</property>
		<property name="CLogoutt" type="java.util.Date" insert="false">
			<column name="C_LOGOUTT" length="7" />
		</property>
    </class>
<!-- 那些supervisor_id IS NULL的就是老板 
<sql-query name="findCompanyAllBoss">
      <return alias="modu" class="com.asiainfo.authority.hibernate.pojo.TAuthorityUser">
	  </return>
	  <![CDATA[	
SELECT 
  t1.N_UID AS {modu.NUid}, 
  t1.C_ULOGNAME AS {modu.CUlogname}, 
  t1.C_UNAME AS {modu.CUname}, 
  t1.C_UPASSWORD AS {modu.CUpassword}, 
  t1.C_USEX AS {modu.CUsex}, 
  t1.employee_number AS {modu.EmployeeNumber}, 
  t1.supervisor_id AS {modu.SupervisorId}, 
  f_getPUserIdById(t1.supervisor_id) AS {modu.SupervisorName}, 
  (SELECT COUNT(*) FROM tool.t_authority_user t2 WHERE t2.supervisor_id = t1.n_uid) AS {modu.FollowerNum},
  
  t1.C_UPHONE AS {modu.CUphone}, 
  t1.C_UTEL AS {modu.CUtel}, 
  t1.C_UFAX AS {modu.CUfax}, 
  t1.C_UEMAIL AS {modu.CUemail}, 
  t1.C_UQQ AS {modu.CUqq}, 
  t1.C_UADDR AS {modu.CUaddr}, 
  t1.C_UNOTE AS {modu.CUnote}, 
  t1.N_IID AS {modu.NIid}, 
  f_getInstNameById(t1.N_IID) AS {modu.CIName}, 
  t1.N_DID AS {modu.NDid}, 
  f_getInstNameById(t1.N_DID) AS {modu.CDName}, 
  
  t1.C_UCTIME AS {modu.CUctime}, 
  t1.C_UCIP AS {modu.CUcip}, 
  t1.C_UCREATOR AS {modu.CUcreator}, 
  t1.C_UMTIME AS {modu.CUmtime}, 
  t1.C_UMIP AS {modu.CUmip}, 
  t1.C_UMODIFIER AS {modu.CUmodifier}, 
  t1.C_UONS AS {modu.CUons}, 
  t1.C_UONT AS {modu.CUont}, 
  t1.C_LOGINS AS {modu.CLogins}, 
  t1.C_LOGINIP AS {modu.CLoginip}, 
  t1.C_LOGINT AS {modu.CLogint}, 
  t1.C_LOGOUTT AS {modu.CLogoutt}
FROM
  tool.t_authority_user t1 
WHERE t1.supervisor_id IS NULL ORDER BY 20,C_UNAME                                 

  ]]>
	</sql-query>
-->
<!-- 查询下属, 当user的pojo的成员域都是基本类型时可用 
    <sql-query name="findFollowerNoRecursive">
      <return alias="modu" class="com.asiainfo.authority.hibernate.pojo.TAuthorityUser">
	  </return>
	  <![CDATA[	
SELECT 
  t1.N_UID AS {modu.NUid}, 
  t1.C_ULOGNAME AS {modu.CUlogname}, 
  t1.C_UNAME AS {modu.CUname}, 
  t1.C_UPASSWORD AS {modu.CUpassword}, 
  t1.C_USEX AS {modu.CUsex}, 
  t1.employee_number AS {modu.EmployeeNumber}, 
  t1.supervisor_id AS {modu.SupervisorId}, 
  f_getPUserIdById(t1.supervisor_id) AS {modu.SupervisorName}, 
  (SELECT COUNT(*) FROM tool.t_authority_user t2 WHERE t2.supervisor_id = t1.n_uid) AS {modu.FollowerNum},
  
  t1.C_UPHONE AS {modu.CUphone}, 
  t1.C_UTEL AS {modu.CUtel}, 
  t1.C_UFAX AS {modu.CUfax}, 
  t1.C_UEMAIL AS {modu.CUemail}, 
  t1.C_UQQ AS {modu.CUqq}, 
  t1.C_UADDR AS {modu.CUaddr}, 
  t1.C_UNOTE AS {modu.CUnote}, 
  t1.N_IID AS {modu.NIid}, 
  f_getInstNameById(t1.N_IID) AS {modu.CIName}, 
  t1.N_DID AS {modu.NDid},
  f_getInstNameById(t1.N_DID) AS {modu.CDName}, 
  
  t1.C_UCTIME AS {modu.CUctime}, 
  t1.C_UCIP AS {modu.CUcip}, 
  t1.C_UCREATOR AS {modu.CUcreator}, 
  t1.C_UMTIME AS {modu.CUmtime}, 
  t1.C_UMIP AS {modu.CUmip}, 
  t1.C_UMODIFIER AS {modu.CUmodifier}, 
  t1.C_UONS AS {modu.CUons}, 
  t1.C_UONT AS {modu.CUont}, 
  t1.C_LOGINS AS {modu.CLogins}, 
  t1.C_LOGINIP AS {modu.CLoginip}, 
  t1.C_LOGINT AS {modu.CLogint}, 
  t1.C_LOGOUTT AS {modu.CLogoutt}
FROM
  tool.t_authority_user t1  
WHERE t1.supervisor_id = :parentId  ORDER BY 20,C_UNAME                                  

  ]]>
	</sql-query>-->
</hibernate-mapping>
